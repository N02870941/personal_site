<!DOCTYPE html>
<html lang='en' ng-app='app'>
  <script>
  /**
   * Get a local (or not local) JSON file and return its contents
   */
  function loadJSON(url, callback) {
      var xobj = new XMLHttpRequest();
      
      xobj.overrideMimeType("application/json");
      xobj.open('GET', url, true);

      xobj.onreadystatechange = function () {
        if (xobj.readyState == 4 && xobj.status == "200") {
          callback(xobj.responseText);
        }
      };

      xobj.send(null);
   }
  </script>

  <head>
    <script>

    /**
     * Dynamically sets up all of the meta tags
     */
    (function() {
      try {
        loadJSON("./config/client/index.config.json", function(response) {
          let indexConfig = JSON.parse(response);
          let head = document.getElementsByTagName('head')[0];
          let charset = document.createElement('meta');

          // Set the charset
          charset.charset = indexConfig.meta.charset;
          head.appendChild(charset);

          // Look through and create all meta tags
          for (let i in indexConfig.meta.entries) {
            let link = document.createElement('meta');

            // Set the attributes
            link.name = indexConfig.meta.entries[i].name,
            link.content = indexConfig.meta.entries[i].content;

            head.appendChild(link);
          }

        });

      } catch (err) {
        console.error(err);
      }
    })();
    </script>


    <script>
      /**
       * Inject title of page via config file
       */
      (function() {
        try {
          loadJSON("./config/client/index.config.json", function(response) {
            let indexConfig = JSON.parse(response);

            // Set the title
            let head = document.getElementsByTagName('head')[0];
            document.title = indexConfig.title;

            // Create the favicon
            let favicon = document.createElement('link');
            favicon.rel = indexConfig.favicon.rel;
            favicon.type = indexConfig.favicon.type;
            favicon.href = indexConfig.favicon.href;
            head.appendChild(favicon);

            // Insert all css CDNs
            for (let i in indexConfig.cdn.css) {
              let link = document.createElement('link');
              link.rel = indexConfig.cdn.css[i].rel;
              link.type = indexConfig.cdn.css[i].type;
              link.href = indexConfig.cdn.css[i].href;
              head.appendChild(link);
            }

            // Insert all js CDNs
            for (let i in indexConfig.cdn.js) {
              let link = document.createElement('link');
              link.type = indexConfig.cdn.js[i].type;
              link.href = indexConfig.cdn.js[i].href;
              head.appendChild(link);
            }

          });

        } catch (err) {
          console.error(err);
        }
      })();
    </script>

    <!-- inject:external:css -->
    <link rel="stylesheet" href="dist/font-awesome-4.7.0/css/font-awesome.min.css">
    <!-- endinject -->

    <!-- inject:external:js -->
    <script src="node_modules/angular/angular.js"></script>
    <script src="node_modules/angular-ui-router/release/angular-ui-router.min.js"></script>
    <script src="node_modules/angular-sanitize/angular-sanitize.js"></script>
    <script src="node_modules/angular-animate/angular-animate.js"></script>
    <script src="node_modules/angular-route/angular-route.js"></script>
    <script src="node_modules/jquery/dist/jquery.js"></script>
    <script src="node_modules/angular-css/angular-css.min.js"></script>
    <script src="node_modules/angular-messages/angular-messages.js"></script>
    <script src="node_modules/angular-aria/angular-aria.js"></script>
    <script src="node_modules/angular-material/angular-material.js"></script>
    <script src="bower_components/jquery-gh-readme/dist/jquery.gh-readme.min.js"></script>
    <!-- endinject -->

    <!-- inject:internal:css -->
    <link rel="stylesheet" href="dist/styles.min.css">
    <!-- endinject -->


    <!-- inject:internal:js -->
    <script src="dist/scripts.min.js"></script>
    <!-- endinject -->

  </head>

  <body>
    <jd-rogue-domain-defender></jd-rogue-domain-defender>
    <jd-back-to-top></jd-back-to-top>

    <jd-header id='top' name='top' class="thetop"></jd-header>

    <div class='partial'>
      <div ui-view class='fade'></div>
    </div>

    <jd-footer></jd-footer>
  </body>


</html>
